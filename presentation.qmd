---
title: "What Explains the Gender Pay Gap Across Countries?"
author: 
  - name: Muhammad Nor Hakim bin Mad Yusof (28693310)
  - name: Chanya Kitprapa (34684824)
  - name: Janhavi Bayanwar (35579331)
format: 
  revealjs:
    theme: serif
editor: visual
editor_options: 
  chunk_output_type: console
---

## Problem introduction

-   Investigate how and why gender wage gaps differ across countries

-   Explore factors influencing wage gaps using OECD and World Bank data

------------------------------------------------------------------------

```{r}
#| echo: false
# Load packages
library(fpp3)
library(kableExtra)
library(dplyr)
library(stringr)

```

```{r}
#| echo: false

# Data cleaning and preperation

# Gender wage gap data

gender_wage_gap <- read.csv("Data/gender wage gap across time.csv") %>%
  select(Reference.area, OBS_VALUE, TIME_PERIOD) %>% 
  rename(Country = Reference.area, Gender_Wage_Gap = OBS_VALUE, Year = TIME_PERIOD) %>% 
  arrange(Year)

gender_wage_gap <- gender_wage_gap %>%
  group_by(Country, Year) %>%
  summarise(Gender_Wage_Gap = mean(Gender_Wage_Gap), .groups = "drop")

gender_wage_gap <- gender_wage_gap %>%
  mutate(Country = ifelse(Country == "European Union (27 countries)", "European Union", Country))

# GDP per capita data
gdp <- read.csv("Data/gdp per capita.csv") %>%
  select(-X.1) %>% 
  rename(Country = X)

gdp <- gdp %>%
  pivot_longer(
    cols = starts_with("X"),
    names_to = "Year",
    values_to = "GDP_per_capita"
  ) %>%
  mutate(year = as.integer(sub("X", "", Year))) 

gdp <- gdp %>% 
  select(Country, GDP_per_capita, year) %>% 
  rename(Year = year)

# Merge the two datasets
data <- left_join(gender_wage_gap, gdp, by = c("Country", "Year"))

# Gender stats data

gender <- read.csv("Data/gender stats.csv") 


gender <- gender[-c(15,16,17,18,19), ]

gender <- gender %>% 
  select(-Country.Code, -Series.Code) %>% 
  rename(y = Series.Name, Country = Country.Name)

# Labor force participation, female (% of female pop aged 15-64)
labor_force_participation <- gender %>% 
  filter(y == "Labor force participation rate, female (% of female population ages 15-64) (modeled ILO estimate)") %>% 
  select(-y) %>% 
  pivot_longer(
    cols = -Country,
    names_to = "Year",
    values_to = "Labour_force_participation"
  ) %>%
  mutate(Year = as.integer(sub(".*?(\\d{4}).*", "\\1", Year))) 

# Part time employment, female (% of total female employment)
part_time_employment <- gender %>% 
  filter(y == "Part time employment, female (% of total female employment)") %>% 
  select(-y) %>% 
  pivot_longer(
    cols = -Country,
    names_to = "Year",
    values_to = "Part_time_employment"
  ) %>%
  mutate(Year = as.integer(sub(".*?(\\d{4}).*", "\\1", Year)))
  
# Merge datasets
data <- left_join(data, labor_force_participation, by = c("Country", "Year"))

data <- left_join(data, part_time_employment, by = c("Country", "Year")) 

female_bachelors <- read.csv("Data/female bachelors attainment.csv") %>% 
  rename(Country = X) %>% 
  select(-X.1) %>% 
  mutate(Country = ifelse(Country == "Korea, Rep.", "Korea", Country)) %>% 
  pivot_longer(
    cols = starts_with("X"),
    names_to = "Year",
    values_to = "Female_bachelors") %>%
  mutate(Year = as.integer(sub("X", "", Year))) 

# Merge datasets
data <- left_join(data, female_bachelors, by = c("Country", "Year"))

# Convert data str
data <- data %>% 
  mutate(Labour_force_participation = as.numeric(Labour_force_participation))

```

## Dataset description {.small}

-   **7 developed countries**: Australia, UK, US, Sweden, Japan, Korea, EU\
-   **Timeframe**: 2000–2020\
-   **Data sources**: OECD and World Bank data portals\
-   **Key variables**:
    -   GDP per capita (US$, 2015)
    -   Female labor force participation (%)
    -   Female part-time employment (%)
    -   Female education attainment (Bachelors or equivalent)

------------------------------------------------------------------------

## Snapshot of dataset {.scrollable}
```{r}
#| label: tbl-summary
#| tbl-cap: "Summary of final dataset used for analysis"

data %>% 
  filter(Year == 2020) %>% 
  head() %>% 
  kable()
```

------------------------------------------------------------------------

## Methods {.tiny}

-   Panel data was created by compiling datasets from OECD and World Bank

-   The gender wage gap is expressed as:

$$
\text{Wage Gap} = \frac{\text{Men's median pay} - \text{Women's median pay}}{\text{Men's median pay}} \times 100
$$

-   Time series plots were used to observe trends and variations and to compare against the OECD average of **11%**

-   Tools: R packages (tidyverse, ggplot2)

------------------------------------------------------------------------

## Results - Gender wage gap

-   Gender wage gaps **declined** in all countries studied

-   **Korea and Japan**: highest, slowest to improve

-   **Sweden and EU**: lowest gaps, most consistent improvements

-   **Australia, UK, US**: moderate progress with fluctuations

------------------------------------------------------------------------

```{r}
#| label: fig-medianwagegap
#| fig-cap: "Gender wage gap across countries (2000-2020)"
#| echo: false

ggplot(data, aes(x = Year, y = Gender_Wage_Gap, color = Country)) +
  geom_line(size = 1.2) +
  geom_point(size = 2) +
  labs(
    x = "Year",
    y = "Gender Wage Gap (%)",
    color = "Country"
  ) +
  theme_minimal() +
  geom_hline(yintercept = 11, linetype = "dashed", color = "red")

```

------------------------------------------------------------------------

## Results - GDP vs Gender wage gap

-   No clear relationship between **high GDP** and **low wage gaps**

-   Example: US and Australia have high GDP but still notable wage gaps

-   Structural factors matter more than income level

------------------------------------------------------------------------

```{r}
#| label: fig-wagegapvsgdp
#| fig-cap: "Gender wage gap vs GDP per capita across countries (2000-2020)"
#| echo: false

data_filtered <- data %>% 
  filter(Country !="Korea")

data_gdp <- data_filtered %>%
  mutate(GDP_per_capita = str_replace_all(GDP_per_capita, "[^0-9.]", ""),
         GDP_per_capita = as.numeric(GDP_per_capita))

ggplot(data_gdp, aes(x = GDP_per_capita, y = Gender_Wage_Gap, colour = Country)) +
  geom_point(size = 4) +
  labs(
    x = "GDP per Capita (US$, 2015)",
    y = "Gender Wage Gap (%)",
    color = "Country"
  ) +
  theme_minimal() +
  geom_hline(yintercept = 11, linetype = "dashed", color = "red")
```

------------------------------------------------------------------------

## Results - Women’s education attainment

-   All countries saw an increase in female bachelor’s degree attainment
-   Most countries converged above 36% by 2020
-   Higher education ≠ lower wage gap

------------------------------------------------------------------------

```{r}
#| label: fig-femaleeducation
#| fig-cap: "Evolution of female education attainment across countries (2013-2020)"
#| echo: false

education_filtered <- data %>%
  filter(Year >= 2013, !Country %in% c("European Union", "Japan", "Korea"))

education_filtered <- education_filtered %>% 
  mutate(Female_bachelors = as.numeric(Female_bachelors))

ggplot(education_filtered, aes(x = Year, y = Female_bachelors, color = Country, group = Country)) +
  geom_line(size = 1.2) +
  labs(
    x = "Year",
    y = "Bachelor's Degree Attainment (%)",
    color = "Country"
  ) +
  theme_minimal()

```

------------------------------------------------------------------------

## Results - Female part-time employment vs gender wage gap

-   Positive correlation: more female part-time → higher wage gap
-   Japan and UK showed strongest relationship
-   Sweden maintains low wage gap despite high part-time rates

------------------------------------------------------------------------

```{r}
#| label: fig-wagegapvsparttime
#| fig-cap: "Gender wage gap vs Part-time female employment (2000-2020)"

data_filtered_new <- data %>% 
  filter(!Country %in% c("Korea", "Japan"))
  
ggplot(data_filtered, aes(x = Labour_force_participation, y = Gender_Wage_Gap, color = Year)) +
  geom_point(size = 2, alpha = 0.7) +
  facet_wrap(~ Country) +
  scale_color_viridis_c() +
  labs(
    x = "Part-time female employment (%)",
    y = "Median Gender Wage Gap (%)",
    color = "Year"
  ) +
  theme_minimal() +
  scale_x_discrete(breaks = seq(2000, 2020, by = 5)) +
  geom_hline(yintercept = 11, linetype = "dashed", color = "red")

```

------------------------------------------------------------------------

## Conclusion

-   Gender wage gaps are narrowing overall, but **unevenly**

-   Progress depends on consistent, structural policy interventions

-   **Economic equity** benefits individuals and the broader economy

-   Cultural change and leadership access are key to long-term equity

------------------------------------------------------------------------

## Recommendations

1.  Enforce pay transparency and gender pay reporting
2.  Expand access to childcare and flexible work
3.  Promote women in leadership through quotas or sponsorship
4.  Track wage gaps with standard indicators
5.  Encourage girls in STEM and eliminate biased hiring
